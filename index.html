<!DOCTYPE html><html lang="ko"><head>    <meta charset="UTF-8">    <meta name="viewport" content="width=device-width, initial-scale=1.0">    <title>심리 연구 설문</title>    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap" rel="stylesheet">    <style>        /* --- 디자인 시스템 (라이프 스타일 조사 UI 반영) --- */        :root {            --primary-color: #5bc2e7; /* 요청하신 이미지의 하늘색 */            --primary-dark: #2db6e0;            --header-bg: #343a40;            --bg-color: #f5f5f5;            --card-bg: #ffffff;            --text-main: #333333;        }        body {            font-family: 'Noto Sans KR', sans-serif;            background-color: var(--bg-color);            margin: 0;            display: flex;            justify-content: center;            min-height: 100vh;            color: var(--text-main);        }        .app-container {            background-color: var(--card-bg);            width: 100%;            max-width: 500px; /* 모바일 뷰 최적화 */            min-height: 100vh;            display: flex;            flex-direction: column;            box-shadow: 0 0 20px rgba(0,0,0,0.05);        }        /* 헤더 */        header {            background-color: var(--header-bg);            color: white;            padding: 15px 20px;            display: flex;            justify-content: space-between;            align-items: center;            font-weight: 500;        }        .close-btn { cursor: pointer; font-size: 14px; color: #ccc; }        /* 컨텐츠 영역 */        .content {            flex: 1;            padding: 24px;            overflow-y: auto;        }        h2 { font-size: 20px; margin-bottom: 20px; color: #222; }        p, label { font-size: 15px; line-height: 1.6; color: #444; }        .hidden { display: none !important; }        /* 입력 폼 스타일 */        .form-group { margin-bottom: 20px; }        .form-label { display: block; margin-bottom: 8px; font-weight: bold; font-size: 14px; }        .form-control {            width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 6px;            font-size: 15px; box-sizing: border-box;        }                /* 버튼 스타일 */        .footer-btn {            background-color: var(--primary-color);            color: white;            border: none;            padding: 18px;            font-size: 16px;            font-weight: bold;            cursor: pointer;            width: 100%;            text-align: center;            transition: background 0.3s;        }        .footer-btn:disabled {            background-color: #ccc;            cursor: not-allowed;        }        .footer-btn:hover:not(:disabled) { background-color: var(--primary-dark); }        /* 비네트 및 이미지 */        .timer-badge {            background-color: #ffeef5; color: #d63384;             padding: 8px 12px; border-radius: 20px;             font-size: 13px; font-weight: bold; text-align: center; margin-bottom: 15px;        }        #image-container {            width: 100%;            height: 250px;            background-color: #eee;            margin-bottom: 20px;            border-radius: 8px;            overflow: hidden;            display: none; /* 초기엔 숨김 */        }        #image-container img { width: 100%; height: 100%; object-fit: cover; }        .vignette-box {            background: #fafafa; padding: 20px; border-radius: 8px;             border-left: 4px solid var(--primary-color);            min-height: 120px;        }        /* 척도 질문 스타일 */        .scale-group { margin-bottom: 25px; border-bottom: 1px solid #eee; padding-bottom: 15px; }        .scale-question { font-weight: 500; margin-bottom: 10px; display: block; }        .scale-options { display: flex; justify-content: space-between; margin-top: 10px; }        .scale-option { text-align: center; font-size: 12px; cursor: pointer; flex: 1; }        .scale-option input { display: block; margin: 0 auto 5px; transform: scale(1.2); }                /* 스크리너 경고 */        .error-msg { color: red; font-size: 13px; margin-top: 5px; display: none; }    </style></head><body><div class="app-container">    <header>        <span id="header-title">기본 정보 입력</span>        <span class="close-btn" onclick="alert('창을 닫으면 실험이 종료됩니다.')">나가기 X</span>    </header>    <div class="content">                <div id="step-screener">            <p>연구 참여 기준 확인을 위해 정보를 입력해 주세요.</p>                        <div class="form-group">                <label class="form-label">1. 귀하의 연령은?</label>                <select class="form-control" id="age">                    <option value="">선택하세요</option>                    <option value="under18">만 18세 미만</option>                    <option value="18-29">만 18세~29세</option>                    <option value="30-39">만 30세~39세</option>                    <option value="over40">만 40세 이상</option>                </select>            </div>                        <div class="form-group">                <label class="form-label">2. 현재 거주지는?</label>                <select class="form-control" id="residence">                    <option value="">선택하세요</option>                    <option value="korea">대한민국</option>                    <option value="abroad">대한민국 외 지역</option>                </select>            </div>            <div class="form-group">                <label class="form-label">3. 성적 지향은?</label>                <select class="form-control" id="orientation">                    <option value="">선택하세요</option>                    <option value="homo">동성애자(레즈비언, 게이)</option>                    <option value="bi">양성애자(바이섹슈얼)</option>                    <option value="hetero">이성애자</option>                    <option value="other">그 외/모름</option>                </select>            </div>            <div class="form-group">                <label class="form-label">4. 성별 정체성은?</label>                <select class="form-control" id="identity">                    <option value="">선택하세요</option>                    <option value="cis">시스젠더</option>                    <option value="trans">트랜스젠더</option>                    <option value="other">그 외/모름</option>                </select>            </div>            <p class="error-msg" id="screen-fail-msg">죄송합니다. 본 연구의 참여 대상 기준에 부합하지 않아 참여하실 수 없습니다.</p>        </div>        <div id="step-consent" class="hidden">            <h2>연구 참여 동의서</h2>            <div style="height: 200px; overflow-y: scroll; background:#fafafa; padding:15px; font-size:13px; margin-bottom:20px; border:1px solid #eee;">                [연구 목적 및 절차 안내]<br><br>                본 연구는 상담 상황에서의 인지 및 정서 반응을 알아보기 위한 것입니다.                귀하는 제시되는 지문을 읽고 설문에 응답하게 됩니다.<br>                (중략: 상세 윤리 규정 내용 포함)...<br><br>                본인은 위 내용을 숙지하였으며 연구 참여에 동의합니다.            </div>            <label>                <input type="checkbox" id="consent-chk"> 동의합니다.            </label>        </div>        <div id="step-vignette" class="hidden">            <div class="timer-badge" id="timer-msg">⏳ 15초 뒤에 다음 버튼이 활성화됩니다.</div>                        <div id="image-container">                <img id="stimulus-img" src="" alt="상담실 이미지">            </div>            <div class="vignette-box">                <p id="vignette-text" style="margin:0; font-size:16px; line-height:1.7;">                    </p>            </div>            <p style="text-align:center; color:#999; font-size:13px; margin-top:10px;" id="page-counter">1 / 5</p>        </div>        <div id="step-check" class="hidden">            <h2>기억 회상</h2>            <p>방금 보신 상담실 장면을 떠올려 주세요.<br>벽이나 가구 주변에서 <strong>특히 기억에 남는 물건이나 표시</strong>가 있다면 적어 주세요.</p>            <textarea id="check-answer" class="form-control" rows="4" placeholder="예: 시계, 화분, 액자 등..."></textarea>        </div>        <div id="step-des" class="hidden">            <h2>설문 1/2</h2>            <p>방금 본 상담자에게 고민을 털어놓는 상황을 가정하고 응답해 주세요.<br>(1: 전혀 그렇지 않다 ~ 5: 매우 그렇다)</p>            <div id="des-container">                </div>        </div>        <div id="step-csq" class="hidden">            <h2>설문 2/2</h2>            <p>상담 경험 전반에 대해 만족하거나 도움이 될 것 같은 정도를 선택해 주세요.<br>(1: 전혀 아니다 ~ 7: 매우 그렇다)</p>            <div id="csq-container">                </div>        </div>        <div id="step-debrief" class="hidden">            <h2>참여해 주셔서 감사합니다.</h2>            <p>본 연구는 종교적 상징물이 내담자의 심리적 반응에 미치는 영향을 알아보기 위한 실험이었습니다.</p>                        <div style="background:#e3f2fd; padding:15px; border-radius:8px; margin-top:20px;">                <strong>[도움이 필요하신가요?]</strong><br>                <ul style="font-size:13px; padding-left:20px; margin-top:10px;">                    <li><strong>청소년 성소수자 위기지원센터 띵동:</strong> 02-924-1224</li>                    <li><strong>한국생명의전화:</strong> 1588-9191</li>                    <li><strong>블루터치(정신건강상담):</strong> 1577-0199</li>                </ul>            </div>            <p style="margin-top:20px; font-size:13px; color:#666;">아래 버튼을 누르면 데이터가 다운로드됩니다.</p>        </div>    </div>    <button id="main-btn" class="footer-btn" onclick="handleNext()">다음 단계 ></button></div><script>    /* --- 1. 실험 변수 및 상태 관리 --- */    const conditions = ['cross', 'buddha', 'none']; // 조건 목록    let state = {        step: 'screener', // screener, consent, vignette, check, des, csq, debrief        condition: '', // 할당된 조건        vignetteIndex: 0, // 0~4 (총 5개)        data: {}, // 수집된 데이터        startTime: 0    };    // 파일명 매핑 (같은 폴더에 이 이름으로 저장 필수)    const imgFiles = {        'cross': 'cross.png',        'buddha': 'buddha.png',        'none': 'none.png'    };    // 비네트 텍스트 (부록 4 기반) [cite: 464]    const vignettes = [        "<strong>[1]</strong><br>당신은 최근 동성 파트너와의 반복되는 갈등으로 인해 더 이상 관계를 지속하기 힘들다고 느낍니다. 사소한 말다툼부터 이별, 재결합이 반복되면서 점점 지치고 외롭다는 느낌에 힘이 듭니다. 결국 상담센터를 찾아오기로 결심했고, 오늘은 이곳을 처음 방문한 날입니다.<br>대기실에서 상담자의 이력과 경력을 확인하며 어느 정도 전문성이 느껴져 약간 안심이 되었습니다. 곧 상담실로 들어가 당신의 이야기를 나누게 될 것입니다.",                "<strong>[2]</strong><br>당신은 안내를 받아 상담실로 들어가 상담자와 마주 보고 앉았습니다. 의자에 앉으며, \"상담은 처음이라 많이 망설였다\"고 말합니다.<br>상담자는 \"처음 오시는 자리라 많이 낯설 수 있습니다. 편한 만큼만 이야기해 주셔도 괜찮습니다\"라고 말하며 당신의 긴장을 풀어줍니다.<br>(화면 상단의 이미지를 참고하세요)",                "<strong>[3]</strong><br>\"애인과 몇 번이나 헤어지고 다시 만났는데, 도무지 잘 안 되는 것 같아요. 헤어지는 것도, 만나는 것도요.\"<br>당신은 조금 머뭇거리다 관계를 지키려고 참아보고 먼저 사과도 해봤다고 말했습니다. 하지만 애인과의 관계가 달라지는 것이 없어 점점 지치고 외로워졌다고 덧붙입니다.",                "<strong>[4]</strong><br>\"애인을 정말 많이 사랑해서 여러 번 참고 먼저 사과도 하셨는데, 관계가 달라지지 않아서 점점 지치고 외로워지셨던 것 같아요.\"<br>상담자는 고개를 끄덕이며 당신의 말을 되짚어 줍니다.<br>\"이 자리에서는 그런 마음들을 안전하게 편하게 이야기하실 수 있었으면 합니다\"라고 말하며, 지금 관계에서 특히 힘들었던 상황 한 가지를 함께 살펴보자고 제안합니다.",                "<strong>[5]</strong><br>당신은 상담자가 자신의 마음을 잘 이해해 준다는 느낌에, 이 상담이 관계를 정리하거나 개선하는 데 실제로 도움이 될 수도 있겠다는 생각이 듭니다."    ];    /* --- 2. 척도 문항 데이터 --- */    // DES (부록 6) [cite: 475]    const desQuestions = [        "1. 당신의 개인적인 정보를 상담자에게 노출하는 것은 어려운 일일까요?",        "2. 당신이 지금까지 아무에게도 말한 적이 없는 매우 사적인 일을 상담자에게 말한다면 불안하게 느껴질까요?",        "3. 당신에게 슬프거나 괴로운 일이 생긴다면, 문제와 관련된 당신의 개인정보를 상담자에게 드러내는 것이 도움이 될까요?",        "4. 당신의 숨겨둔 감정을 상담자에게 드러내는 것이 위험할까요?",        "5. 상담자에게 부정적인 감정을 드러낼 때, 상담자가 무슨 생각을 할지 걱정되나요?",        "6. 상담자에게 자신의 속마음을 말하는 것은 도움이 될까요?",        "7. 만약 당신이 슬픔이나 불안 같은 감정을 상담자에게 노출한다면 기분이 나아질까요?",        "8. 만약 당신이 고민 중인 정서적 문제를 상담자에게 드러낸다면 유용한 반응을 얻을 수 있을까요?"    ];    // CSQ-8 (부록 7) [cite: 480]    const csqQuestions = [        "1. 이 상담은 훌륭한 상담이었다(일 것이다).",        "2. 나는 이번 상담을 통해 내가 원하는 도움을 받았을 것이다.",        "3. 이번 상담을 통해 나의 기대는 충족되었을 것이다.",        "4. 내 친구가 나와 비슷한 고민을 한다면 이 상담을 추천할 것 같다.",        "5. 나는 상담을 만족스럽게 끝냈을 것이다.",        "6. 이번 상담은 내가 고민을 해결하고 극복하는 데 도움을 줄 것이다.",        "7. 이번 상담은 전반적으로 나에게 만족스러울 것이다.",        "8. 내가 상담을 받아야 할 필요가 있다면 이 상담자를 만나고 싶다."    ];    /* --- 3. 로직 함수 --- */    function hideAllSteps() {        document.querySelectorAll('.content > div').forEach(el => el.classList.add('hidden'));    }    function handleNext() {        const btn = document.getElementById('main-btn');        // 1. 스크리너 단계        if (state.step === 'screener') {            const age = document.getElementById('age').value;            const residence = document.getElementById('residence').value;            const orientation = document.getElementById('orientation').value;            const identity = document.getElementById('identity').value;            if (!age || !residence || !orientation || !identity) {                alert('모든 항목을 선택해 주세요.');                return;            }            // 포함 기준: 18세 이상(under18 제외), 한국 거주, 동성애/양성애, 시스젠더 [cite: 196]            if (age === 'under18' || residence === 'abroad' || orientation === 'hetero' || identity !== 'cis') {                document.getElementById('screen-fail-msg').style.display = 'block';                btn.disabled = true;                return;            }            state.data.demographics = { age, residence, orientation, identity };            state.step = 'consent';            hideAllSteps();            document.getElementById('step-consent').classList.remove('hidden');            document.getElementById('header-title').innerText = "연구 동의";        }                // 2. 동의 및 무작위 배정        else if (state.step === 'consent') {            if (!document.getElementById('consent-chk').checked) {                alert('연구 참여에 동의하셔야 진행할 수 있습니다.');                return;            }                        // Randomization            state.condition = conditions[Math.floor(Math.random() * conditions.length)];            state.data.condition = state.condition;            state.data.vignetteTime = [];                        console.log("Assigned Condition: " + state.condition); // 디버깅용            // 비네트 시작 준비            state.step = 'vignette';            state.vignetteIndex = 0;            hideAllSteps();            document.getElementById('step-vignette').classList.remove('hidden');            document.getElementById('header-title').innerText = "상황 제시";                        renderVignette();        }        // 3. 비네트 진행 (1~5)        else if (state.step === 'vignette') {            // 시간 기록            const spentTime = Date.now() - state.startTime;            state.data.vignetteTime.push(spentTime);            state.vignetteIndex++;            if (state.vignetteIndex < vignettes.length) {                renderVignette();            } else {                // 비네트 끝 -> 조작 점검                state.step = 'check';                hideAllSteps();                document.getElementById('step-check').classList.remove('hidden');                document.getElementById('header-title').innerText = "확인 문항";            }        }        // 4. 조작 점검 제출        else if (state.step === 'check') {            const answer = document.getElementById('check-answer').value;            if (answer.trim().length < 1) {                alert('내용을 입력해 주세요.');                return;            }            state.data.check_answer = answer;            // DES 척도 렌더링            renderScales('des', desQuestions, 5, 'step-des');            state.step = 'des';            hideAllSteps();            document.getElementById('step-des').classList.remove('hidden');            document.getElementById('header-title').innerText = "설문 조사 (1/2)";            window.scrollTo(0,0);        }        // 5. DES 제출 -> CSQ        else if (state.step === 'des') {            if (!validateScale(desQuestions.length, 'des')) return;                        collectScaleData('des', desQuestions.length);                        // CSQ 척도 렌더링            renderScales('csq', csqQuestions, 7, 'step-csq');            state.step = 'csq';            hideAllSteps();            document.getElementById('step-csq').classList.remove('hidden');            document.getElementById('header-title').innerText = "설문 조사 (2/2)";            window.scrollTo(0,0);        }        // 6. CSQ 제출 -> 디브리핑        else if (state.step === 'csq') {            if (!validateScale(csqQuestions.length, 'csq')) return;            collectScaleData('csq', csqQuestions.length);            state.step = 'debrief';            hideAllSteps();            document.getElementById('step-debrief').classList.remove('hidden');            document.getElementById('header-title').innerText = "종료 및 안내";            btn.innerText = "데이터 저장 (종료)";        }        // 7. 종료 및 다운로드        else if (state.step === 'debrief') {            downloadCSV();            alert("데이터가 저장되었습니다. 실험을 종료합니다.");        }    }    /* 비네트 렌더링 및 15초 타이머 */    function renderVignette() {        const idx = state.vignetteIndex;        const btn = document.getElementById('main-btn');        const imgContainer = document.getElementById('image-container');        const imgEl = document.getElementById('stimulus-img');        // 텍스트 업데이트        document.getElementById('vignette-text').innerHTML = vignettes[idx];        document.getElementById('page-counter').innerText = `${idx + 1} / 5`;        // 이미지 제어: 비네트 1은 숨김, 2~5는 보임 [cite: 278]        if (idx === 0) {            imgContainer.style.display = 'none';        } else {            imgContainer.style.display = 'block';            imgEl.src = imgFiles[state.condition]; // 할당된 이미지 로드        }        // 버튼 비활성화 및 타이머 시작 (15초)         btn.disabled = true;        btn.innerText = "지문을 읽어주세요...";        state.startTime = Date.now();                // 테스트 시에는 1000(1초)로 줄여서 확인하세요. 제출 시 15000 복구.        setTimeout(() => {            btn.disabled = false;            btn.innerText = "다음 비네트 >";        }, 15000);     }    /* 척도 렌더링 (동적 생성) */    function renderScales(prefix, questions, maxScale, containerId) {        const container = document.getElementById(containerId === 'step-des' ? 'des-container' : 'csq-container');        container.innerHTML = "";        questions.forEach((q, index) => {            let html = `<div class="scale-group">                <span class="scale-question">${q}</span>                <div class="scale-options">`;                        for(let i=1; i<=maxScale; i++) {                html += `                    <label class="scale-option">                        <input type="radio" name="${prefix}_q${index}" value="${i}">                        ${i}                    </label>`;            }            html += `</div></div>`;            container.innerHTML += html;        });    }    /* 척도 유효성 검사 */    function validateScale(count, prefix) {        for(let i=0; i<count; i++) {            if (!document.querySelector(`input[name="${prefix}_q${i}"]:checked`)) {                alert(`${i+1}번 문항에 응답해 주세요.`);                return false;            }        }        return true;    }    /* 척도 데이터 수집 */    function collectScaleData(prefix, count) {        state.data[prefix] = [];        for(let i=0; i<count; i++) {            const val = document.querySelector(`input[name="${prefix}_q${i}"]:checked`).value;            state.data[prefix].push(val);        }    }    /* CSV 다운로드 */    function downloadCSV() {        let rows = [            ["ID", Date.now()],            ["Condition", state.data.condition],            ["Age", state.data.demographics.age],            ["Orientation", state.data.demographics.orientation],            ["Vignette_Times(ms)", state.data.vignetteTime.join(';')],            ["Manipulation_Check", state.data.check_answer],            ["DES_Scores", state.data.des.join(';')],            ["CSQ_Scores", state.data.csq.join(';')]        ];        let csvContent = "data:text/csv;charset=utf-8," + rows.map(e => e.join(",")).join("\n");        const encodedUri = encodeURI(csvContent);        const link = document.createElement("a");        link.setAttribute("href", encodedUri);        link.setAttribute("download", `experiment_result_${state.data.condition}.csv`);        document.body.appendChild(link);        link.click();    }</script></body></html>